using Microsoft.AspNetCore.Mvc;
using Microsoft.IdentityModel.Tokens;
using Version_1_API.Model;
using Version_1_API.Services;

namespace Version_1_API.Controllers
{
    [Route("api/accountManager")]
    [ApiController]
    public class AccountManagerController : Controller
    {
        private AccountManagerSvc _accountManagerSvc;


        [HttpPost("auth")]
        public ObjectResult Authenticate(RequestParameter<string>[] credentials)
        {
            _accountManagerSvc = AccountManagerSvc.GetInstance();

            if (RequestParameter<string>.get("email", credentials).IsNullOrEmpty())
            {
                return BadRequest(new Response<string>((int)EApiExecCode.ERROR, "Empty email provided.", String.Empty));
            }

            return Ok(_accountManagerSvc.AuthenticateAddress(
                RequestParameter<string>.get("email", credentials),
                RequestParameter<string>.get("password", credentials)
            ));
        }

    }
}
